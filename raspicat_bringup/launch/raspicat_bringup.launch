<?xml version="1.0"?>
<launch>
  <!-- Arguments -->
  <arg name="imu"         default="false"/>
  <arg name="joy"         default="false"/>
  <arg name="urg"         default="false"/>
  <arg name="rplidar"     default="false"/>
  <arg name="vlp16"       default="false"/>
  <arg name="lidar_ether" default="false"/>
  <arg name="lidar_usb"   default="true"/>

  <arg name="lidar_frame_id"    default="lidar_link"/>

  <arg name="imu_serial_port"   default="/dev/ttyACM1"/>
  <arg name="joy_dev"           default="/dev/input/js0"/>
  <arg name="lidar_serial_port" default="/dev/ttyACM0"/>
  <arg name="lidar_ip_address"  default="192.16.0.10"/>

  <!-- Raspberry Pi Cat nodes -->
  <include file="$(find raspicat_bringup)/launch/raspicat_core.launch"/>
  
  <!-- URG node -->
  <node if="$(arg urg)" pkg="urg_node" name="urg_node" type="urg_node" required="true">
    <param name="frame_id" value="$(arg lidar_frame_id)"/>
    <param if="$(arg lidar_ether)"  name="ip_address"   value="$(arg lidar_ip_address)"/>
    <param if="$(arg lidar_usb)"    name="serial_port"  value="$(arg lidar_serial_port)"/>
  </node>

  <!-- Rplidar_ros -->
  <node if="$(arg rplidar)" pkg="rplidar_ros" name="rplidarNode" type="rplidarNode" output="screen">
    <param name="serial_port"         type="string" value="/dev/ttyUSB0"/>  
    <param name="serial_baudrate"     type="int"    value="256000"/>
    <param name="frame_id"            type="string" value="$(arg lidar_frame_id)"/>
    <param name="inverted"            type="bool"   value="false"/>
    <param name="angle_compensate"    type="bool"   value="true"/>
  </node>

  <!-- VLP16 -->
  <include if="$(arg vlp16)" file="$(find velodyne_pointcloud)/launch/VLP16_points.launch">
    <arg name="laserscan_resolution"    value="0.004"/>
    <arg name="laserscan_ring"          value="-1"/>
    <arg name="frame_id"                value="$(arg lidar_frame_id)"/>
    <arg name="min_range"               value="0.693"/>
    <arg name="max_range"               value="103.95"/>
    <arg name="view_direction"          value="0.0"/>
    <arg name="view_width"              value="4.335"/>
  </include>

  <!-- rt_usb_9axisimu_driver -->
  <include if="$(arg imu)" file="$(find rt_usb_9axisimu_driver)/launch/rt_usb_9axisimu_driver.launch">
    <arg name="port" value="$(arg imu_serial_port)" />
  </include>

  <!-- Joy node -->
  <group if="$(arg joy)">
    <include file="$(find raspicat_gamepad_controller)/launch/logicool.launch">
      <arg name="dev" value="$(arg joy_dev)"/>
    </include>

    <include file="$(find raspicat_gamepad_controller)/launch/smooth.launch"/>
  </group>
</launch>